<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<h4>B62 to Hex</h4>
<div class="form">
    B62: <input type="text" name="input" id="input_b62" size="32" value="6GGODyP2LIdbxIfYxy5UbN">
</div>
Hex: <span id="output_hex">Hex will be shown here</span>

<br/>
<br/>

<h4>Hex to B62</h4>
<div class="form">
    Hex: <input type="text" name="input" id="input_hex" size="48" value="dbc3d5ebe344484da3e2448712a02213">
</div>

B62: <span id="output_b62">B62 will be shown here</span>


<script src="bundle_browser.js"></script>
<script>
    window.Module = {}
    let Rb62 = {
        getInteger: function (str) {
            let buf = newStr(Module, str);
            let outptr = Module.get_integer(buf);
            console.log(buf); // sanity check no memory loss
            Module.dealloc_str(buf);
            let result = getStr(Module, outptr, 32);
            return result;
        },
        getB62: function (str) {
            let buf = newStr(Module, str);
            let outptr = Module.get_b62(buf);
            console.log(buf); // sanity check no memory loss
            Module.dealloc_str(buf);
            let result = getStr(Module, outptr, 22);
            return result;
        },
    };
    fetchAndInstantiate("./pkg/rb62_wasm_bg.wasm", {})
        .then(mod => {
            Module.alloc = mod.exports.alloc;
            Module.dealloc = mod.exports.dealloc;
            Module.dealloc_str = mod.exports.dealloc_str;
            Module.memory = mod.exports.memory;

            Module.get_integer = mod.exports.get_integer;

            Module.get_b62 = mod.exports.get_b62;

            const input_b62 = document.getElementById("input_b62");
            const output_hex = document.getElementById("output_hex");

            output_hex.innerText = Rb62.getInteger(input_b62.value);
            input_b62.addEventListener("keyup", function (e) {
                output_hex.innerText = Rb62.getInteger(input_b62.value);
            });

            const input_hex = document.getElementById("input_hex");
            const output_b62 = document.getElementById("output_b62");
            output_b62.innerText = Rb62.getB62(input_hex.value);
            input_hex.addEventListener("keyup", function (e) {
                output_b62.innerText = Rb62.getB62(input_hex.value);
            });
        });
</script>
</body>
</html>
